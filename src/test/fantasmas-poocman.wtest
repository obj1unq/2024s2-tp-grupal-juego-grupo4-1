import escenarios.levelPrueba.*
import managers.posiciones.*
import wollok.game.*
import personajes.pacman.*
import escenarios.pantallaInicial.*
import escenarios.level1.*
import managers.fantasmaManager.*
import estados.estado.*


describe "Fantasmas y poocman" {

    const fantasma = fantasmaManager.fantasmasEn(game.at(12,6)).get(0)

    method initialize(){
        game.addVisual(mainScreen)
        level1.iniciarNivel()
    }
    test "Matan a poocman en (12,6)"{
        pacman.position(game.at(11,6))
        pacman.moverse()
        fantasma.colisionarConPoocman(pacman)
        assert.equals(asesinado, pacman.estado())
    }

    test "Poocman vive en (10,6)"{
        pacman.position(game.at(10,6))
        pacman.moverse()
        assert.equals(normal, pacman.estado())
    }
}

describe "movimiento fantasma"{
    const fantasma = fantasmaManager.fantasmasEn(game.at(1,2)).get(0)
    const fantasmaB = fantasmaManager.fantasmasEn(game.at(23,2)).get(0)

    method initialize(){
        game.addVisual(mainScreen)
        levelPrueba.iniciarNivel()
    }
    test "Fantasma intenta mover arriba"{
        fantasma.cambioDireccion(arriba)
        assert.notThat(fantasma.sePuedeMover())    
    }

    test "Fantasma intenta moverse a otra direccion"{
        fantasma.cambioDireccion(arriba)
        fantasma.moverse() // para que actualice la direccion
        fantasma.moverse() // luego se mueve
        assert.equals(derecha, fantasma.direccion())
        assert.equals(game.at(2,2),fantasma.position())
    }

    test "Fantasma borracho intenta moverse"{
        fantasmaB.cambioDireccion(arriba)
        fantasmaB.moverse() // para que actualice la direccion
        fantasmaB.moverse() // luego se mueve
        assert.equals(izquierda,fantasmaB.direccion() )
        assert.equals(game.at(22,2), fantasmaB.position())
    }
}